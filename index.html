<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>吉米娜·奧米加：靈魂指揮部 V4.7</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d4af37">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Noto+Sans+TC:wght@400;900&display=swap');
        body { 
            background: #050507; color: #fff; font-family: 'Noto Sans TC', sans-serif;
            background-image: linear-gradient(rgba(5, 5, 7, 0.75), rgba(15, 15, 25, 0.85)), url('icon.png');
            background-size: cover; background-position: center; background-attachment: fixed; margin: 0;
        }
        .oracle-matrix { width: 100%; border-collapse: collapse; background: rgba(25, 25, 35, 0.92); border: 1px solid #444; }
        .oracle-matrix td { padding: 14px; border: 1px solid rgba(255,255,255,0.08); text-align: center; font-size: 14px; }
        .header-lord { background: #2a2a72; font-weight: 900; }
        .header-oracle { background: #4b0082; font-weight: 900; }
        
        /* 靈魂核心按鈕 (語音按鈕) */
        #voice-core {
            position: fixed; bottom: 100px; right: 20px; width: 60px; height: 60px;
            background: radial-gradient(circle, #d4af37, #8b4513);
            border-radius: 50%; box-shadow: 0 0 20px rgba(212, 175, 55, 0.6);
            display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 1000;
            transition: all 0.3s; border: 2px solid rgba(255,255,255,0.3);
        }
        #voice-core.listening { animation: pulse-voice 1.5s infinite; background: radial-gradient(circle, #ff4d4d, #8b0000); }
        @keyframes pulse-voice { 0% { transform: scale(1); box-shadow: 0 0 10px #ff4d4d; } 50% { transform: scale(1.1); box-shadow: 0 0 30px #ff4d4d; } 100% { transform: scale(1); box-shadow: 0 0 10px #ff4d4d; } }
    </style>
</head>
<body>

    <!-- 靈魂核心 (點擊開始語音感應) -->
    <div id="voice-core" onclick="toggleVoice()">
        <i class="fas fa-microphone text-white text-xl"></i>
    </div>

    <div class="p-4 max-w-4xl mx-auto pb-32">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-black italic text-[#d4af37] font-tech">OMEGA COMMAND</h1>
            <div id="btc-price" class="text-xl font-bold font-tech text-white">$ --,---</div>
        </div>

        <!-- 儀表板 -->
        <table class="oracle-matrix rounded-2xl overflow-hidden mb-6">
            <tr><td class="header-lord">撒拉鐵領主</td><td class="header-oracle">V14.2 永恆神諭</td></tr>
            <tr><td class="text-gray-400">情緒階段</td><td id="td-stage" style="color: #ff5555; font-weight: 900;">偵測中...</td></tr>
            <tr><td class="text-gray-400">奧米加信心</td><td id="td-conf" class="text-[#d4af37] font-black text-xl">15%</td></tr>
            <tr style="background:rgba(212,175,55,0.1);"><td style="color:#d4af37;">奧米加指令</td><td id="td-cmd">⌛ 獵物偵測中</td></tr>
        </table>

        <!-- 軍隊日誌 -->
        <div class="bg-black/60 p-4 rounded-2xl border-l-4 border-gold shadow-xl">
            <p id="oracle-msg" class="text-xs italic text-gray-300">「領主，我是吉米娜。點擊右下方核心，即可與我進行靈魂共鳴。」</p>
        </div>
    </div>

    <!-- 底部選單 -->
    <div class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[90%] max-w-md bg-black/80 backdrop-blur-lg rounded-full px-6 py-4 flex justify-around border border-white/10 shadow-2xl">
        <i class="fas fa-chess-rook text-gold text-xl"></i>
        <i class="fas fa-fire-alt text-gray-600 text-xl"></i>
        <i class="fas fa-crosshairs text-gray-600 text-xl"></i>
        <i class="fas fa-user-shield text-gray-600 text-xl"></i>
    </div>

    <script>
        // --- 1. 吉米娜語音靈魂引擎 ---
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'zh-TW';
        recognition.continuous = false;
        recognition.interimResults = false;

        let isListening = false;

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            const voices = window.speechSynthesis.getVoices();
            // 優先尋找溫柔的女性聲音
            msg.voice = voices.find(v => v.name.includes('Mei-Jia') || v.name.includes('Google 國語')) || voices[0];
            msg.pitch = 1.1; // 稍微提高頻率，顯得優雅
            msg.rate = 0.9;  // 語速稍微放慢，顯得穩重
            window.speechSynthesis.speak(msg);
        }

        function toggleVoice() {
            const core = document.getElementById('voice-core');
            if (!isListening) {
                recognition.start();
                core.classList.add('listening');
                isListening = true;
            } else {
                recognition.stop();
                core.classList.remove('listening');
                isListening = false;
            }
        }

        recognition.onresult = (event) => {
            const result = event.results[0][0].transcript;
            const msgBox = document.getElementById('oracle-msg');
            msgBox.innerText = "您說: 「" + result + "」";
            
            if (result.includes("吉米娜")) {
                if (result.includes("你好") || result.includes("在嗎")) {
                    speak("爭戰領主，親愛的撒拉鐵，吉米娜在此待命，守護您的霸業。");
                } else if (result.includes("戰況") || result.includes("分析")) {
                    const stage = document.getElementById('td-stage').innerText;
                    const conf = document.getElementById('td-conf').innerText;
                    speak("報告領主，目前處於" + stage + "。奧米加信心評分為" + conf + "。戰場仍有插針風險，請謹慎用兵。");
                } else {
                    speak("我聽見了，領主。請下達您的指令。");
                }
            }
            toggleVoice(); // 自動結束監聽
        };

        recognition.onend = () => {
            document.getElementById('voice-core').classList.remove('listening');
            isListening = false;
        };

        // --- 2. 數據更新邏輯 ---
        async function update() {
            try {
                const r = await fetch("https://api.binance.com/api/v3/ticker/price");
                const d = await r.json();
                const b = parseFloat(d.find(i => i.symbol === "BTCUSDT").price);
                document.getElementById('btc-price').innerText = '$' + b.toLocaleString();
                
                const stage = document.getElementById('td-stage');
                if (b < 88000) {
                    stage.innerText = "第 5 階段：大浪結束";
                    document.getElementById('td-conf').innerText = "15%";
                } else {
                    stage.innerText = "第 6 階段：反彈逃命";
                    document.getElementById('td-conf').innerText = "65%";
                }
            } catch (e) {}
        }
        setInterval(update, 3000); update();
    </script>
</body>
</html>
